{
  "instrumentation": {
    "java.io": {
      "description": "Java IO instrumentation",
      "rules": [{
        "ruleName": "Java IO PrintWriter Response Append 1",
        "className": "^java.io.PrintWriter",
        "methodName": "println",
        "parameterTypes": [
          "java.lang.String"
        ],
        "location": "ENTRY",
        "condition": "isResponseBufferActive($0)",
        "actions": [{
          "type": "FreeFormAction",
          "action": "appendResponseBuffer($0, $1.getBytes(), 0, $1.length(), false)"
        }]
      },{
        "ruleName": "Java IO PrintWriter Response Close",
        "className": "^java.io.PrintWriter",
        "methodName": "close",
        "parameterTypes": [
        ],
        "location": "ENTRY",
        "condition": "isResponseBufferActive($0)",
        "actions": [{
          "type": "FreeFormAction",
          "action": "recordResponseBuffer($0)"
        }]
      }]
    }
  }
}